int __cdecl main(int argc, const char **argv, const char **envp)
{
  FILE *v4; // eax
  FILE *v5; // edi
  size_t v6; // esi
  _BYTE Src[4096]; // [esp+4h] [ebp-1140h] BYREF
  _BYTE v8[260]; // [esp+1004h] [ebp-140h] BYREF
  _WORD Buffer[5]; // [esp+1108h] [ebp-3Ch] BYREF
  int Offset; // [esp+1112h] [ebp-32h]
  int v11; // [esp+111Ah] [ebp-2Ah]
  int v12; // [esp+111Eh] [ebp-26h]
  __int16 v13; // [esp+1124h] [ebp-20h]
  size_t ElementSize; // [esp+112Ah] [ebp-1Ah]

  if ( argc == 2 )
  {
    memset(Src, 0, sizeof(Src));
    v4 = fopen(argv[1], "rb");
    v5 = v4;
    if ( v4 )
    {
      fread(Buffer, 0x36u, 1u, v4);
      if ( Buffer[0] == 19778 )
      {
        if ( v13 == 24 )
        {
          v6 = 3 * v11 * v12;
          fseek(v5, Offset, 0);
          fread(Src, ElementSize, 1u, v5);
          memcpy(v8, Src, v6);
          fclose(v5);
          return 0;
        }
        else
        {
          perror("This program only supports 24-bit BMP files.");
          fclose(v5);
          return 4;
        }
      }
      else
      {
        perror("Not a BMP file.");
        fclose(v5);
        return 3;
      }
    }
    else
    {
      perror("Error opening file");
      return 2;
    }
  }
  else
  {
    sub_401010("Usage: %s <file_path>\n", (char)*argv);
    return 1;
  }
}